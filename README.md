# YouNoGo

## Introduction
중국에서 시작된 신종 코로나 바이러스 감염증(코로나19)은 현재 전 세계에서 1000만명 이상을 감염시켰다. 
하여 우리나라에서는 ‘사회적 거리두기’ 와 적절한 규제를 이용해 감염병 확산 막기 위해 노력하여 점차 줄어드는 듯 싶었으나 
불가피한 출근, 퇴근, 물품 구비 등이나 안일한 외출로 인해 꺼져가던 불씨가 재점화되었다. 
해당 사건은 최근의 이태원 확진자 이후로 다시 급증하였는데, 이후 클럽 유흥시설 등이나 노래방 ‘n차 감염’ 의 사례가 속출하였으며, 현재 12,850 명이 넘는 국내 확진자가 발생하였다. 
이렇듯 모든 사람들의 행동을 제약하기란 불가능하기에 ‘최대한 예방할 수 없는 방법은 없을까?’를 모색하다 고안해낸 것이 ‘Smart Inspection’이다. <br><br>
해당 프로젝트는 코로나 등의 비말 또는 호흡기 감염으로부터 최대한 안전할 수 있게 다중이용업소나 특정 건물 출입관리를 적절한 센서를 이용해 통제하는 것이 목표이다. 
아직도 다중이용업소인 노래방, 피시방 등이나 식당 또는 특정 건물의 출입 관리가 여전히 미흡하다. 
근래에는 이름 핸드폰의 수기 작성과 체온 검사를 필수로 실시하지만, 직원 또는 아르바이트생이 바쁠 시에는 지속적인 확인이 불가능하다. 
하여, 앞서 제안된 방법을 무엇을 통해 그리고 어떻게 관리할 것인 것 서술하도록 하겠다.


## Scenario
1. 카메라 파이 센서를 통해 사람의 얼굴 인식을 한다.
2. 사람임이 확인되면 적외선 온도 센서를 통해 체온을 측정한다.
3. 측정한 체온 정보를 메인 서버 파이로 보내게 된다. 
    * 이 때, 파이간 송/수신은 이더넷을 이용한 소켓 통신을 사용하며 메인 체온을 통해 자동문의 작동여부가 결정된다. 
4. 설정한 온도 값인 40도보다 높은 온도일 경우에는 LCD에 측정한 온도와 함께 Access Denied가 출력 되며 부저 센서가 작동을 하여 경보가 울려진다. 
5. 40도보다 낮은 온도일 경우에는 LCD에 측정한 온도와 함께 Access Granted가 출력되며 출입문이 열리게 된다.
6. 측정된 온도가 40도 이하이면 출입문이 열려 내부로 들어오게 되고, 입구에 비치된 자동 손소독제를 이용하게 된다. 
    * 손 소독제는 초음파 센서를 통해 물체가 일정 거리 안에 있을 시 자동으로 분사한다.
    * 자동 분사는 서보 모터를 이용
    
## Architecture

### Hardware
* 서보 모터 (SG-90)
> Servo Motor란 ‘주인의 명령에 충실하게 동작하는 모터’를 의미한다. 
일반 모터와는 다르게 별도의 모터가 아닌 서보 또는 사용자에 의해 원하는 속도나 각도로 움직임이 가능하다. 
대체로 로봇의 팔을 움직이는 등 다양한 범위로 사용되고 있는데, 해당 시나리오에서는 손 세정제 자동 분사나 자동 출입문을 구현하기 위해 이용된다. 
‘SG-90’ 의 datasheet에 의하면 서보 모터는 PWM을 사용하여 제어가 가능한데, 해당 pulse width는 1에서 2 ms 사이의 값을 가지며 180 도의 회전이 가능하다.
손 세정제 자동 분사를 위해 서보 모터를 채택하였는데, 모터 하나의 압력으로 손 세정제 분사가 불가능할 것으로 판단하여 두 개를 이용하였다. 
모터의 또 다른  사용처는 자동출입문이며 이는 우드락의 여닫이를 책임지므로 한 개로도 충분하다.

* 비접촉식 적외선 온도 센서 (OSTSen-T007) (TMP007기반)
> 센서를 통해 타겟이 되는 물체가 내보내는 적외선을 흡수하고 그 값을 토대로 온도를 측정한다. 
실제로 개체에 접하지 않고 개체의 온도를 측정할 수 있어서, 사람들의 체온을 직접적인 접촉 없이 측정하기 위해 선택했다. 
센서를 사람의 이마에 갖다 대고 측정된 값을 I2C통신을 통해 전달해 온도를 계산하는 방식을 사용한다.

* 카메라 (Raspberry Pi Camera Module 5MP)
> 라즈베리 파이에 바로 연결하여 사용이 가능한 카메라 모듈로 5메가픽셀의 해상도를 갖고 있다. 
사람의 얼굴을 인식 및 검증하기 위해 사람의 얼굴을 찍을 수 있는 카메라 기능이 필요하여 선택했다. 
라즈베리 파이 설정에서 카메라 사용을 허용해주어야 정상 작동이 되며, 사진, 동영상, 실시간 출력이 가능하다.

* 16x2 LCD 모듈 (I2C)
> 해당 센서는 출력할 String을 16*2 즉 32개의 문자를 출력해 줄 수 있는 센서이다. 
해당 센서를 선택하게 된 이유는 측정한 온도가 몇 도인지, 또 출입이 허가 되었는지 거부 되었는지를 사용자에게 보여주어야 하므로 사용하게 되었다. 
기본 LCD에는 16개의 핀이 있지만, 이를 이용하지 않고 I2C 방식을 사용하여 2개의 선(SDA, SCL)과 GND, VCC 이렇게 총 4개의 핀을 이용하였다.

* 부저 모듈 (SZH-SDBJ-007)
> 위 센서는 전원을 입력할 경우 소리를 출력하는 수동형 부저 모듈이다. 
PWM 신호를 이용하여 주파수에 맞는 신호가 입력되었을 시 소리가 내며 특정 음계를 나타낼 수 있다. 
부저의 사용처는 알람인데, 적정 체온에 적합하지 않는 사람이 감지되었을 경우 매장 직원이나 관리자가 즉각적으로 대응할 수 있게 도와주며 주위 사람들에게 주의를 줄 수 있다.

* 초음파 센서 (HC-SR04)
> 초음파 센서는 주파수가 20kHz를 넘겨 사람이 듣지 못하는 음파를 이용해 Trig, Echo, 그리고 제어회로를 이용해 거리를 센서와 물체 사이의 거리 계산이 가능하다. 
해당 센서는 사람간 접촉의 최소화라는 명목에 맞게 손 세정제에 직접적인 터치없이 분사가 이루어질 수 있게 한다. 
그러나, 이미 수업 시간에서 다루어본 센서이므로 이후의 세부 사항에는  기술되어 있지 않다. 

### Software
* I2C 통신
> I2C란 Inter-Integrated Circuit으로 2가지 선 만을 이용해 다수의 기기와 연결해 통신이 가능하다는 장점이 있다. 
연결 데이터를 주고 받기 위한 SDA와 송수신 타이밍 동기화를 위한 SCL로 구성되어 있으며 이는 Master-Slave 통신으로 이루어져 있다. 
데이터의 송수신은 마스터에서 주도하며, 데이터를 전송하거나 읽어오기 전 슬레이브의 주소를 명시해준 후 통신을 시작하기 때문에, 
긴 데이터 통신보다는 짧은 데이터 통신에 주로 이용된다. 아래는 앞서 설명된 통신을 그림으로 나타낸 것이다.

> I2C 통신은 기본적으로 HIGH 상태를 유지하는데, 이는 통신이 이루어지지 않고 있는 상황을 의미한다. 
만약 master가 통신을 개시하고자 한다면 SDA는 LOW 상태로 변경되고, SCL은 I2C 통신이 시작되었음을 인지하여 클럭 주기를 생성한다. 
통신이 완료되면 master는 통신을 종료하며 SCL이 HIGH 상태로 돌아오게 되고 그 이후에 SDA 또한 HIGH로 변환된다. 
위 과정을 끝낼시 비로서 I2C 통신이 전체적으로 완료된다.  

* 소켓 통신
> Server와 Client간의 통신을 위해 사용한 방식이다. 
Client는 Server의 IP주소를 알아야 하며 통신을 위한 port의 number 또한 알아야 한다. 
Port number는 Server에서 지정해주는데 지정해준 port number로 Client에서 사용한다.

